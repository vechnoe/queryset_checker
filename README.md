# Queryset checker

## Описание
Приложение для проверки массива входных данных состоящих из объектов
чисел в формате JSON:

    [
	    {
	    	"a": 1,
	    	"b": 2
	    }
    ]

Пользователю доступен функционал загрузки входного массива данных
а также функционал запуска обработки многих ранее загруженных масивов
только после логина в приложение. Для неавторизованного пользователя
доступен просмотр входных данных, результата и ошибок. Также доступен
просмотр общего последнего статуса обработки.

Авторизованный пользователь отправляет через форму на главной странице 
приложения массив входных данных (query) в соответствующем формате. 
Загруженные, но необработаные данные отображаются со статусом unknown.

После загрузки необходимого количества массивов данных пользователь
запускает обработку в ассинхронном режиме всех массивов данных 
нажатием кнопки **process** в интерфейсе. После некоторого времени
будут доступны для просмотра результаты и исключения (если есть). 
После загрузки доступны для просмотра на главной странице статусы для 
кажого набора данных. *False* соответствует набору данных, обработка 
которого завершилась с ошибками, *true* -- для набора, в процессе 
обработки которого ошибок не было.

Для детального просмотра (на отдельной странице) для каждого набора 
данных доступны:
1. Входной массив данных
2. Результат (если есть). Если при обработке были ошибки, но некоторые
   элементы входного массива данных были корректно обработанны, то по 
   этим элементам отображается результат.
3. Список исключений с трассировочной информацмей (если есть). 
   Исключение отображается для каждого некорретного элемента массива. 
   В трассировочной информации отображается класс ошибки, сообщение об 
   ошибке, некоретный элемент массива.
 

## Установка (на Debian 8):
Сначала установка недостающих пакетов:
    
    sudo apt update 
    sudo apt install rabbitmq-server git-core python3-setuptools \
    python3-virtualenv python3-pip python-virtualenv postgresql-9.5 \
    postgresql-client-9.5 postgresql-contrib libpq-dev python3-dev \

Создание БД и пользователя:

    CREATE USER checker WITH password '123456';
    ALTER USER checker CREATEDB;
    CREATE DATABASE checker;
    GRANT ALL privileges ON DATABASE checker TO checker;
    
Клонирование репозитория и сборка проекта:

    git clone git://github.com/vechnoe/queryset_checker && cd queryset_checker
    make
    
## Запуск в режиме разработки:
    make run

Сервер будет доступен на *127.0.0.1:8000*

Логин: *admin*
Пароль: *12345*

Необходимо запустить воркеры Celery (в разных консолях):

    make celery_queries_node
    make celery_data_node
    make celery_results_node

Запуск celery-flower:
    
    make celery-flower
    
Celery-flower будет доступен на *127.0.0.1:9999*

Запуск модульных тестов:
    
    make test